{layout '../layout.latte'}

{block content}

<block head>
    <link rel="stylesheet" href="{$basePath}/css/style.css">
</block>

<!-- Profilová sekce -->
<h2>Profile Information</h2>
<div class="profile-section" hx-get="{$presenter->link(':MyProfile:myProfile')}" hx-trigger="load" hx-target=".profile-section">
    <p><strong>Name:</strong> {$profile->name}</p>
    <p><strong>Email:</strong> {$profile->email}</p>
</div>

<h2>Edit Profile</h2>
<div hx-get="{$basePath}/myProfile/edit" hx-trigger="click" hx-target="this">
    {control profileForm}
</div>

<hr>

<!-- Formulář pro změnu hesla -->
<div class="password-change-section">
    <h3>Change Password</h3>
    <div hx-get="{$basePath}/myProfile/passwordChange" hx-trigger="click" hx-target="this">
        {control changePasswordForm}
    </div>
</div>

<hr>

<!-- Sekce výpůjček -->
<div class="loans-section">
    <h2>Your Loans</h2>

    <!-- Aktuální a budoucí výpůjčky -->
    <div class="current-loans" hx-get="{$basePath}/myProfile/currentLoans" hx-trigger="load" hx-target=".current-loans">
        <h3>Current and Upcoming Loans</h3>

        {if count($currentLoans)}
            <ul>
                {foreach $currentLoans as $loan}
                    <li>
                        <strong>Device:</strong> {$loan->device->name}<br>
                        <strong>Loan Start:</strong> {$loan->loan_start|date:'d-m-Y H:i'}<br>
                        <strong>Loan End:</strong> {$loan->loan_end|date:'d-m-Y H:i'}<br>
                        <strong>Status:</strong> {$loan->status}
                    </li>
                {/foreach}
            </ul>
        {else}
            <p>No current or upcoming loans.</p>
        {/if}
    </div>

    <!-- Minulé výpůjčky -->
    <div class="past-loans" hx-get="{$basePath}/myProfile/pastLoans" hx-trigger="load" hx-target=".past-loans">
        <h3>Past Loans</h3>

        {if count($pastLoans)}
            <ul>
                {foreach $pastLoans as $loan}
                    <li>
                        <strong>Device:</strong> {$loan->device->name}<br>
                        <strong>Loan Start:</strong> {$loan->loan_start|date:'d-m-Y H:i'}<br>
                        <strong>Loan End:</strong> {$loan->loan_end|date:'d-m-Y H:i'}<br>
                        <strong>Status:</strong> {$loan->status}
                    </li>
                {/foreach}
            </ul>
        {else}
            <p>No past loans.</p>
        {/if}
    </div>
</div>

{/block}
